{% extends "core/base_core.html" %}

{% block title %}Ubuntu image builder{% endblock %}
{% block meta_description %}Build your own image with pre-installed applications online{% endblock meta_description %}
{% block meta_copydoc %}https://docs.google.com/document/d/1Hw_8dWAAUpHHm5Z_XNUVJaSVE5k5i2Vt6WANcJYUZvY/edit{% endblock meta_copydoc %}

{% block content %}

{% if build_info %}
<section class="p-strip--suru-topped">
  <div class="row">
    <h1>Build started</h1>
    <p>We've kicked off <a href="{{ build_info.web_link }}">your build</a>.</p>
    <pre>{{ build_info | tojson }}</pre>
  </div>
</section>
{% elif build_error %}
<section class="p-strip--suru-topped">
  <div class="row">
    <h1>Build error</h1>
    <p>{{ build_error }}</p>
  </div>
</section>
{% else %}
<section class="p-strip--suru-topped is-bordered">
  <div class="row">
    <div class="col-7">
      <h1>Build an Ubuntu IoT image</h1>
      <p>Choose your board, Ubuntu version, and the apps you want installed, and in a few minutes we’ll build an Ubuntu image ready for your IoT development.</p>
    </div>
    {% if openid %}
    <div class="col-5 col-start-large-8">
      <div class="u-no-margin--bottom p-card">
        <p>You are signed in as {{ openid.fullname }}<br />
        <small style="color:#666">({{ openid.email }})</small></p>
        <p class="u-no-margin--bottom">
          <a href="/logout?return_to={{ request.host_url }}core/build" class="p-button--neutral u-no-margin--bottom" onclick="dataLayer.push({
            'event' : 'GAEvent',
            'eventCategory' : 'Advantage',
            'eventAction' : 'Authentication',
            'eventLabel' : 'Sign out',
            'eventValue' : undefined
          });">Sign out</a>
        </p>
      </div>
    </div>
    {% else %}
    <div class="col-5 col-start-large-8">
      <div class="u-no-margin--bottom p-card">
        <p>
          You need an Ubuntu One account so we can keep track of which image is yours.
        </p>
        <p class="u-no-margin--bottom">
          <a href="/login" class="p-button--neutral u-no-margin--bottom"
            onclick="dataLayer.push({
              'event' : 'GAEvent',
              'eventCategory' : 'Advantage',
              'eventAction' : 'Authentication',
              'eventLabel' : 'Sign in',
              'eventValue' : undefined
            });">
            Sign in
          </a>
        </p>
      </div>
    </div>
    {% endif %}
  </div>
</section>

<div {% if not openid %}class="u-disable"{% endif %}>
  <section class="p-strip js-step-1">
    <div class="row">
      <div class="col-8 u-sv3">
        <h2><span class="u-number-circle">1</span> What board are you using?</h2>
      </div>
    </div>
    <div class="row js-boards">
      <button class="col-3 p-card js-selection">
        <h4 class="js-name">Raspberry Pi2</h4>
        <hr class="u-sv1">
        <img src="https://assets.ubuntu.com/v1/8542c958-Raspberry+Pi+2.png" alt="">
      </button>
      <button class="col-3 p-card js-selection">
        <h4 class="js-name">Raspberry Pi3</h4>
        <hr class="u-sv1">
        <img src="https://assets.ubuntu.com/v1/c4a007b6-Raspberry+Pi+3.png" alt="">
      </button>
      <button class="col-3 p-card js-selection">
        <h4 class="js-name">Raspberry Pi4</h4>
        <hr class="u-sv1">
        <img src="https://assets.ubuntu.com/v1/a999bb5f-Raspberry+Pi+4.png" alt="">
      </button>
      <button class="col-3 p-card js-selection">
        <h4 class="js-name">Intel NUC</h4>
        <hr class="u-sv1">
        <img src="https://assets.ubuntu.com/v1/347b2456-intelnuc.png" alt="">
      </button>
    </div>
  </section>

  <section class="p-strip is-shallow js-step-2">
    <div class="row">
      <div class="col-8 u-sv3">
        <h2><span class="u-number-circle">2</span> What version of Ubuntu do you want?</h2>
      </div>
    </div>
    <div class="row js-os">
      <button class="col-2 p-card js-selection" data-supports="raspberry-pi2 raspberry-pi3 intel-nuc">
        <h4 class="js-name">Core 16</h4>
        <hr class="u-sv1"/>
        <p class="p-card__content">Use if your apps or existing devices require it.</p>
      </button>
      <button class="col-2 p-card js-selection" data-supports="raspberry-pi2 raspberry-pi3 raspberry-pi4 intel-nuc">
        <p class="js-name">Core 18</p>
        <hr class="u-sv1"/>
        <p class="p-card__content">Recommended for the most advanced security.</p>
      </button>
      <button class="col-2 p-card js-selection" data-supports="raspberry-pi2 raspberry-pi3">
        <p class="js-name">Classic 16.04</p>
        <hr class="u-sv1"/>
        <p class="p-card__content">Use if your apps or existing devices require it.</p>
      </button>
      <button class="col-2 p-card js-selection" data-supports="raspberry-pi2 raspberry-pi3 raspberry-pi4">
        <p class="js-name">Classic 18.04</p>
        <hr class="u-sv1"/>
        <p class="p-card__content">Recommended for best memory efficiency.</p>
      </button>
      <button class="col-2 p-card js-selection" data-supports="raspberry-pi3 raspberry-pi4">
        <p class="js-name">Classic 64-bit 18.04</p>
        <hr class="u-sv1"/>
        <p class="p-card__content">Recommended for best maths performance.</p>
      </button>
    </div>
  </section>

  <section class="p-strip is-shallow js-step-3">
    <div class="row">
      <div class="col-10 u-sv3">
        <h2><span class="u-number-circle">3</span> What packages do you want preinstalled?</h2>
        <p>Select the applications that will be pre-installed on the device. For Ubuntu Core this will be snaps, for Ubuntu Classic it will be snaps or packages.</p>
      </div>
    </div>
    <div class="row">
      <div class="col-6">
        <h4>Available snaps:</h4>
        <form class="p-search-box js-snap-search">
          <input type="search" class="p-search-box__input" name="search" placeholder="Search for snaps" required="">
          <button type="reset" class="p-search-box__reset" alt="reset"><i class="p-icon--close"></i></button>
          <button type="submit" class="p-search-box__button" alt="search"><i class="p-icon--search"></i></button>
        </form>
        <div class="p-card has-limited-height">
          <div class="js-snap-results"></div>
        </div>
      </div>
      <div class="col-6">
        <h4>Your chosen snaps:</h4>
        <div class="p-card has-limited-height--large">
          <div class="js-preinstalled-snaps-list"></div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-8">
        <p>Got an app that isn’t in the Snap Store? Learn how to <a href="https://snapcraft.io/">publish it as a snap</a>.</p>
      </div>
    </div>
  </section>

  <section class="p-strip--light is-shallow">
    <div class="row">
      <div class="col-8">
        <form method="POST">
          <p>We’ll email you at {{ openid.email }} once the build is ready.</p>
          <p>
            <input class="mktoField" value="yes" id="canonicalUpdatesOptIn" name="canonicalUpdatesOptIn" type="checkbox">
            <label class="mktoLabel mktoHasWidth" for="canonicalUpdatesOptIn">I agree to receive information about Canonical’s products and services.</label>
          </p>
          <input type="hidden" name="board" value="cm3" />
          <input type="hidden" name="system" value="core16" />
          <input type="hidden" name="snaps" value="toto,code,toto-fran" />
          <p><button class="p-button--positive js-build-button">Build image</button></p>
        </form>
      </div>
    </div>
  </section>
</div>
<script src="{{ versioned_static('js/build/imageBuilder.min.js') }}"></script>

{% with first_item="_core_learn_more", second_item="_core_contribute", third_item="_iot_further_reading" %}{% include "shared/contextual_footers/_contextual_footer.html" %}{% endwith %}

  <!-- Set default Marketo information for contact form below-->
  <div class="u-hide" id="contact-form-container" data-form-location="/shared/forms/interactive/_embedded" data-form-id="1266" data-lp-id="2166" data-return-url="https://www.ubuntu.com/core/thank-you" data-lp-url="https://pages.ubuntu.com/things-contact-us.html">
  </div>

{% endif %}

{% endblock content %}


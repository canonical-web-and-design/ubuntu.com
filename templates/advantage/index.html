{% extends "advantage/base_advantage.html" %}

{% block title %}Ubuntu Advantage for Infrastructure{% endblock %}
{% block meta_description %}Ubuntu Advantage for Infrastructure offers a single, per-node packaging of the most comprehensive software, security and IaaS support in the industry, with OpenStack support, Kubernetes support included, and Livepatch, Landscape and Extended Security Maintenance to address security and compliance concerns.{% endblock %}
{% block meta_copydoc %}https://docs.google.com/document/d/1AW8wQu1Uvq0xFtd_c2JwNdic075MPOTx7k2KHqFPPeo/edit{% endblock meta_copydoc %}

{% block content %}
<section class="p-strip--suru is-dark is-deep">
  <div class="row">
    <div class="col-8">
      <h1>Ubuntu Advantage for Infrastructure</h1>
      <p>Ubuntu Advantage for Infrastructure is the most comprehensive Linux enterprise subscription, covering all aspects of open infrastructure.</p>
    </div>
  </div>
</section>


{% if openid %}
<section class="p-strip" style="overflow:visible;">
  <div class="row">
    <div class="col-10">
      <h2>You are signed in</h2>
      <p>{{ openid.fullname }} ({{ openid.email }})</p>
      <a href="/logout?return_to={{ request.host_url }}advantage" class="p-button--neutral u-no-margin--bottom">Sign out</a>
    </div>
  </div>

  <div class="u-fixed-width">
    <hr class="p-separator">
  </div>

  <div class="row">
    <div class="col-6 u-sv3">
      <h2>Your personal subscription</h2>
      <p>You are entitled to use Ubuntu Advantage Essential on 3 machines.</p>
      <aside class="p-accordion" role="tablist" aria-multiselect="true" style="border: 1px solid #cdcdcd;">
        <ul class="p-accordion__list" style="margin-bottom: 0;">
          <li class="p-accordion__group">
            <button type="button" class="p-accordion__tab" id="tab1" role="tab" aria-controls="#tab1-section" aria-expanded="false">Show instructions</button>
            <section class="p-accordion__panel" id="tab1-section" role="tabpanel" aria-hidden="true" aria-labelledby="tab1-section" style="padding: 0 1rem;">
              <p>To attach a machine:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua attach {{ personal_account.free_token }}" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To detach:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua detach {{ personal_account.free_token }}" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </section>
          </li>
        </ul>
      </aside>
    </div>
  </div>

  <div class="row">
    <div class="col-12">
      <ul class="p-inline-list advantage-instructions u-no-margin--bottom">
        <li class="p-inline-list__item">Get instructions for using:</li>
        {% if personal_account['affordances']['livepatch'] %}
        <li class="p-inline-list__item">
          <span class="p-contextual-menu u-hide--small">
            <a href="#" class="p-contextual-menu__toggle" aria-controls="#menu-livepatch" aria-expanded="false" aria-haspopup="true">Livepatch</a>
            <span class="p-contextual-menu__dropdown" id="menu-livepatch" aria-hidden="true" aria-label="submenu" style="min-width: 20rem; right: -9rem; padding: 1rem;">
              <p>To activate Livepatch:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua enable livepatch" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To deactivate Livepatch:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua disable livepatch" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </span>
          </span>
          <div class="u-hide u-show--small">
            <br /><br />
            <div class="p-card u-no-margin--bottom">
              <h4>Livepatch</h4>
              <p>To activate Livepatch:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua enable livepatch" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To deactivate Livepatch:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua disable livepatch" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </div>
          </div>
        </li>
        {% endif %}
        {% if personal_account['affordances']['esm'] %}
        <li class="p-inline-list__item">
          <span class="p-contextual-menu u-hide--small">
            <a href="#" class="p-contextual-menu__toggle" aria-controls="#menu-esm" aria-expanded="false" aria-haspopup="true">ESM</a>
            <span class="p-contextual-menu__dropdown" id="menu-esm" aria-hidden="true" aria-label="submenu" style="min-width: 20rem; right: -9rem; padding: 1rem;">
              <p>To activate ESM:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua enable esm" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To deactivate ESM:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua disable esm" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </span>
          </span>
          <div class="u-hide u-show--small">
            <div class="p-card u-no-margin--bottom">
              <h4>ESM</h4>
              <p>To activate ESM:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua enable esm" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To deactivate ESM:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua disable esm" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </div>
          </div>
        </li>
        {% endif %}
        {% if personal_account['affordances']['fips'] %}
        <li class="p-inline-list__item">
          <span class="p-contextual-menu u-hide--small">
            <a href="#" class="p-contextual-menu__toggle" aria-controls="#menu-fips" aria-expanded="false" aria-haspopup="true">FIPS</a>
            <span class="p-contextual-menu__dropdown" id="menu-fips" aria-hidden="true" aria-label="submenu" style="min-width: 20rem; right: -9rem; padding: 1rem;">
              <p>To activate FIPS:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua enable fips" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To deactivate FIPS:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua disable fips" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </span>
          </span>
          <div class="u-hide u-show--small">
            <div class="p-card u-no-margin--bottom">
              <h4>FIPS</h4>
              <p>To activate FIPS:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua enable fips" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To deactivate FIPS:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua disable fips" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </div>
          </div>
        </li>
        {% endif %}
        {% if personal_account['affordances']['cc-eal'] %}
        <li class="p-inline-list__item">
          <span class="p-contextual-menu u-hide--small">
            <a href="#" class="p-contextual-menu__toggle" aria-controls="#menu-eal2" aria-expanded="false" aria-haspopup="true">Canonical Common Criteria EAL2 Provisioning</a>
            <span class="p-contextual-menu__dropdown" id="menu-eal2" aria-hidden="true" aria-label="submenu" style="min-width: 20rem; padding: 1rem;">
              <p>To activate EAL2:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua enable cc-eal" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To deactivate EAL2:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua disable cc-eal" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </span>
          </span>
          <div class="u-hide u-show--small">
            <div class="p-card u-no-margin--bottom">
              <h4>EAL2</h4>
              <p>To activate EAL2:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua enable cc-eal" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>

              <p>To deactivate EAL2:</p>
              <div class="p-code-copyable">
                <input class="p-code-copyable__input" value="sudo ua disable cc-eal" readonly="readonly">
                <button class="p-code-copyable__action">Copy to clipboard</button>
              </div>
            </div>
          </div>
        </li>
        {% endif %}
      </ul>
    </div>
  </div>

  <div class="u-fixed-width">
    <hr class="p-separator">
  </div>

  {% include "advantage/_table.html" %}
</section>

<script>
  let toggleElements = document.querySelectorAll('.p-accordion__tab');
  toggleElements.forEach(function(el) {
    el.addEventListener(
    "click",
    function(e) {
      e.preventDefault();
      toggleElements.forEach(function(el) {
        el.setAttribute('aria-expanded', el.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');
        panel = document.querySelector('.p-accordion__panel');
        panel.setAttribute('aria-hidden', panel.getAttribute('aria-hidden') === 'true' ? 'false' : 'true');
      });
    },
    false
    );
  });
</script>

<script>
  function toggleMenu(element, show) {
    element.setAttribute('aria-expanded', show);
    document
      .querySelector(element.getAttribute('aria-controls'))
      .setAttribute('aria-hidden', !show);
  }

  function setupContextualMenuListeners(contextualMenuToggleSelector) {
    const toggles = document.querySelectorAll(contextualMenuToggleSelector);

    toggles.forEach(toggle => {
      toggle.addEventListener('click', e => {
        e.preventDefault();

        const target = e.target;
        const menuAlreadyOpen = target.getAttribute('aria-expanded') === 'true';

        toggleMenu(target, !menuAlreadyOpen)
      });
    });

    document.addEventListener('click', e => {
      toggles.forEach(toggle => {
        const contextualMenu = document.querySelector(toggle.getAttribute('aria-controls'));
        const clickOutside = !(toggle.contains(e.target) || contextualMenu.contains(e.target));

        if (clickOutside) {
          toggleMenu(toggle, false);
        }
      })
    });

    document.onkeydown = e => {
      e = e || window.event;

      if (e.keyCode === 27) {
        toggles.forEach(toggle => {
          toggleMenu(toggle, false);
        });
      }
    };
  }

  setupContextualMenuListeners('.p-contextual-menu__toggle');
</script>

{% else %}
<section class="p-strip--light">
  <div class="row u-equal-height">
    <div class="col-12 u-vertically-center">
      <h2>Already subscribed?</h2>
      <p class="u-no-margin--bottom"><a href="/login" class="p-button--positive">Sign in</a> to access your personal or paid subscriptions.</p>
    </div>
  </div>
  <div class="u-fixed-width">
    <hr class="p-separator">
  </div>
  <div class="row">
    <div class="col-12">
      <h3>Free for personal use</h3>
      <p>Anyone can use UA Infrastructure Essential for free on up to 3 machines (limitations apply).  All you need is an Ubuntu One account. And if you’re a recognised <a href="https://wiki.ubuntu.com/Membership" class="p-link--external">Ubuntu community member</a>, it’s free on up to 50 machines.</p>
      <p class="u-no-margin--bottom"><a href="/login" class="p-button--neutral">Register</a> to get your free subscription.</p>
    </div>
  </div>


  <div class="u-fixed-width">
    <hr class="p-separator">
  </div>

  {% include "advantage/_table.html" %}
</section>
{% endif %}

<section class="p-strip--light">
  <div class="row u-equal-height">
    <div class="col-6 u-align--center u-hide--small">
      <img src="https://assets.ubuntu.com/v1/9c7bda7d-contact-us.svg" alt="">
    </div>
    <div class="col-6 u-vertically-center">
      <div>
        <h2>Got questions?</h2>
        <p class="u-no-margin--bottom"><a href="/support/contact-us" class="p-button--positive js-invoke-modal">Contact us</a> about buying an enterprise subscription.</p>
      </div>
    </div>
  </div>
</section>

{% with first_item="_support_landscape", second_item="_support_contact_us", third_item="_further_reading" %}{% include "shared/contextual_footers/_contextual_footer.html" %}{% endwith %}

{% endblock content %}

